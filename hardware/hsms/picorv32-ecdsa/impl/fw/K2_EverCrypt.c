/*
  This file was generated by KaRaMeL <https://github.com/FStarLang/karamel>
  KaRaMeL invocation: /Users/anish/Documents/Anish/src/notary/everest/karamel/krml -library EverCrypt,EverCrypt.* /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Pervasives_Native.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Pervasives.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Squash.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Classical.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_StrongExcludedMiddle.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Classical_Sugar.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_List_Tot_Base.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_List_Tot_Properties.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_List_Tot.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Preorder.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Sealed.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Range.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Calc.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Mul.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Math_Lib.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Math_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Seq_Base.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Seq_Properties.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Seq.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Float.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_BitVector.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_UInt.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_UInt32.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Char.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Pprint.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Issue.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_TypeChecker_Core.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_Common.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_Types.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_Types.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_Result.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Monotonic_Pure.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_Effect.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_PropositionalExtensionality.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_VConfig.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Ghost.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_Unseal.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Sealed_Inhabited.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Syntax_Syntax.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V2_Data.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Order.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V2_Builtins.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_Const.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_V2_Builtins.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_SMT.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_Util.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V2_Derived.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V2_Compare.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V2_Derived_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V2.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_Visit.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_NamedView.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V1_Data.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V1_Builtins.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_V1_Builtins.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_Builtins.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_V2_SyntaxCoercions.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_V2_SyntaxHelpers.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V2_Formula.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_V2_Derived.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_Print.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_IndefiniteDescription.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V1_Derived.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V1_Formula.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V1_Compare.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V1_Derived_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V1.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_V1_SyntaxHelpers.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_V1_Derived.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_V1_Logic.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_V1.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Exn.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_FunctionalExtensionality.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Set.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Monotonic_Witnessed.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_ErasedLogic.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_PredicateExtensionality.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_TSet.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Monotonic_Heap.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Heap.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_ST.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_All.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_LoopCombinators.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Int.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Int64.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Int32.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Int16.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Int8.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_UInt64.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_UInt16.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_UInt8.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Int_Cast.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_List.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_BV.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V2_TermEq.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_Typeclasses.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_MApply.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_V2_Logic.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_V2.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Reflection_V2_Arith.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_BV.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_UInt128.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Int_Cast_Full.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Int128.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_IntTypes.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_Sequence.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_Sequence_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Map.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Monotonic_HyperHeap.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Monotonic_HyperStack.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_HyperStack.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_HyperStack_ST.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Universe.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_GSet.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_ModifiesGen.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_BigOps.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/LowStar_Monotonic_Buffer.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/LowStar_Buffer.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_Memzero0.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/LowStar_BufferOps.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Loops.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/C_Loops.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_Loops.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_RawIntTypes.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_ByteSequence.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/LowStar_ImmutableBuffer.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/LowStar_ConstBuffer.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_Buffer.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Endianness.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/LowStar_Endianness.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_ByteBuffer.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_HyperStack_All.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_IntVector_Intrinsics.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_GaloisField.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_AES.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_IntVector.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_IntVector_Serialize.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_SHA2_Types.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_SHA3_Constants.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_SHA3.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_UpdateMulti.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Blake2_Definitions.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Blake2.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Hash_Definitions.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_SHA1.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_MD5.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_SHA2_Constants.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_SHA2.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Hash_MD.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Agile_Hash.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Hash_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Hash_Incremental_Definitions.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_MD_Incremental.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_SHA3_Incremental.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Blake2_Alternative.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Blake2_Incremental.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Hash_Incremental.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_Blake2_Core.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/LowStar_Modifies.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Hash_Definitions.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_IntVector_Transpose.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_SHA2.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_NTuple.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_SHA2_Vec.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_MultiBuffer.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_SHA2_Core.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_Vec_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_UpdateMulti_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_SHA2_EquivScalar.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_SHA2_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_SHA2_Equiv.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_SHA2_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_SHA2_Scalar32_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_SHA2_Generic.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_SHA2_Scalar32.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_Exponentiation_Definition.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_Canon.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Math_Euclid.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Algebra_CommMonoid.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Tactics_CanonCommSemiring.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Math_Fermat.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_NatMod.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Montgomery_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_Definitions.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_ModInvLimb.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_Convert.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_Base.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_Lib.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_Comparison.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Lib.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_Addition.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_Multiplication.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_Squaring.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Karatsuba_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_Karatsuba.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_Montgomery.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_AlmostMontgomery_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_Exponentiation.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Exponentiation.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Exponentiation_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_MontExponentiation.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_AlmostMontgomery.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_AlmostMontExponentiation.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_Exponentiation.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_ModInv.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_MontArithmetic.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/LowStar_Ignore.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_Definitions.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_Convert.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Lib_IntTypes_Intrinsics.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_Base.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_Lib.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_Comparison.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_Lib.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_Addition.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_Multiplication.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_Karatsuba.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_ModInvLimb.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_Montgomery.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_PrecompTable.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_Exponentiation_Definitions.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_PrecompTable.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_Exponentiation.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_AlmostMontgomery.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_AlmostMontExponentiation.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_MontExponentiation.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_Exponentiation.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_ModInv.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_MontArithmetic.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_P256_PointOps.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_P256_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_P256.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_Bignum_ModReduction.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_ModReduction.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum_SafeAPI.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Bignum256.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_P256_Montgomery.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_Bignum.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_Constants.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_Field.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_P256_Finv.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_Finv.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_Point.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_PointDouble.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_PointAdd.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_Group.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_PrecompBaseTable256.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_PrecompBaseTable.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_P256_PrecompTable.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_P256_PrecompTable.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_MultiExponentiation.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_PointMul.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_Scalar.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_DH.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_Compression.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_Blake2_Constants.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_Blake2_Generic.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_SHA3_Equivalence.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_SHA3.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Hash_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Hash_PadFinish.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Hash_MD.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Hash_SHA2.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Hash_Core_SHA1.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Hash_SHA1.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Hash_Core_MD5.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Hash_MD5.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_Integers.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Streaming_Interface.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Streaming_Types.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Streaming_Spec.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Streaming_Functor.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Streaming_MD.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Streaming_SHA2.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Spec_P256_Qinv.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_Qinv.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_Verify.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Impl_P256_Sign.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_P256.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Streaming_Blake2_Common.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Blake2b_32.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Streaming_Blake2b_32.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Hash_Blake2b_32.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Blake2s_32.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Streaming_Blake2s_32.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_Hash_Blake2s_32.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Spec_Agile_HMAC.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/C.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/FStar_String.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/C_String.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/EverCrypt_Helpers.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/Hacl_HMAC.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/K2_Framework_Hacks.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/K2_Framework.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/K2_Ecdsa_Spec.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/K2_Ecdsa_IO.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/K2_Ecdsa_Lemmas.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/K2_Ecdsa_Lib.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/K2_Ecdsa_Impl.krml /Users/anish/Documents/Anish/src/notary/everest/merkle-tree/obj/K2.krml -tmpdir dist -skip-compilation -minimal -add-include "krml/internal/target.h" -add-include "krml/internal/types.h" -add-include "krml/lowstar_endianness.h" -add-include <stdint.h> -add-include <stdbool.h> -add-include <string.h> -fparentheses -o libmerkletree.a -no-prefix K2 -bundle K2+K2.Ecdsa.Impl=K2.*[rename=K2] -bundle LowStar.* -bundle Prims,C.Failure,C,C.String,C.Loops,Spec.Loops,C.Endianness,FStar.*[rename=K2_Krmllib] -bundle Meta.*,Hacl.*,Spec.*,Lib.*,EverCrypt,EverCrypt.*[rename=K2_EverCrypt]
  F* version: 13bd96aa
  KaRaMeL version: 95968326
 */

#include "internal/K2_EverCrypt.h"

#include "internal/K2_Krmllib.h"

static const
uint32_t
h256[8U] =
  {
    0x6a09e667U, 0xbb67ae85U, 0x3c6ef372U, 0xa54ff53aU, 0x510e527fU, 0x9b05688cU, 0x1f83d9abU,
    0x5be0cd19U
  };

static const
uint32_t
k224_256[64U] =
  {
    0x428a2f98U, 0x71374491U, 0xb5c0fbcfU, 0xe9b5dba5U, 0x3956c25bU, 0x59f111f1U, 0x923f82a4U,
    0xab1c5ed5U, 0xd807aa98U, 0x12835b01U, 0x243185beU, 0x550c7dc3U, 0x72be5d74U, 0x80deb1feU,
    0x9bdc06a7U, 0xc19bf174U, 0xe49b69c1U, 0xefbe4786U, 0x0fc19dc6U, 0x240ca1ccU, 0x2de92c6fU,
    0x4a7484aaU, 0x5cb0a9dcU, 0x76f988daU, 0x983e5152U, 0xa831c66dU, 0xb00327c8U, 0xbf597fc7U,
    0xc6e00bf3U, 0xd5a79147U, 0x06ca6351U, 0x14292967U, 0x27b70a85U, 0x2e1b2138U, 0x4d2c6dfcU,
    0x53380d13U, 0x650a7354U, 0x766a0abbU, 0x81c2c92eU, 0x92722c85U, 0xa2bfe8a1U, 0xa81a664bU,
    0xc24b8b70U, 0xc76c51a3U, 0xd192e819U, 0xd6990624U, 0xf40e3585U, 0x106aa070U, 0x19a4c116U,
    0x1e376c08U, 0x2748774cU, 0x34b0bcb5U, 0x391c0cb3U, 0x4ed8aa4aU, 0x5b9cca4fU, 0x682e6ff3U,
    0x748f82eeU, 0x78a5636fU, 0x84c87814U, 0x8cc70208U, 0x90befffaU, 0xa4506cebU, 0xbef9a3f7U,
    0xc67178f2U
  };

static void sha256_init(uint32_t *hash)
{
  for (uint32_t i = 0U; i < 8U; i++)
  {
    uint32_t *os = hash;
    uint32_t x = h256[i];
    os[i] = x;
  }
}

static void sha256_update(uint8_t *b, uint32_t *hash)
{
  uint32_t hash_old[8U] = { 0U };
  uint32_t ws[16U] = { 0U };
  memcpy(hash_old, hash, 8U * sizeof (uint32_t));
  uint8_t *b10 = b;
  uint32_t u = load32_be(b10);
  ws[0U] = u;
  uint32_t u0 = load32_be(b10 + 4U);
  ws[1U] = u0;
  uint32_t u1 = load32_be(b10 + 8U);
  ws[2U] = u1;
  uint32_t u2 = load32_be(b10 + 12U);
  ws[3U] = u2;
  uint32_t u3 = load32_be(b10 + 16U);
  ws[4U] = u3;
  uint32_t u4 = load32_be(b10 + 20U);
  ws[5U] = u4;
  uint32_t u5 = load32_be(b10 + 24U);
  ws[6U] = u5;
  uint32_t u6 = load32_be(b10 + 28U);
  ws[7U] = u6;
  uint32_t u7 = load32_be(b10 + 32U);
  ws[8U] = u7;
  uint32_t u8 = load32_be(b10 + 36U);
  ws[9U] = u8;
  uint32_t u9 = load32_be(b10 + 40U);
  ws[10U] = u9;
  uint32_t u10 = load32_be(b10 + 44U);
  ws[11U] = u10;
  uint32_t u11 = load32_be(b10 + 48U);
  ws[12U] = u11;
  uint32_t u12 = load32_be(b10 + 52U);
  ws[13U] = u12;
  uint32_t u13 = load32_be(b10 + 56U);
  ws[14U] = u13;
  uint32_t u14 = load32_be(b10 + 60U);
  ws[15U] = u14;
  for (uint32_t i0 = 0U; i0 < 4U; i0++)
  {
    for (uint32_t i = 0U; i < 16U; i++)
    {
      uint32_t k_t = k224_256[16U * i0 + i];
      uint32_t ws_t = ws[i];
      uint32_t a0 = hash[0U];
      uint32_t b0 = hash[1U];
      uint32_t c0 = hash[2U];
      uint32_t d0 = hash[3U];
      uint32_t e0 = hash[4U];
      uint32_t f0 = hash[5U];
      uint32_t g0 = hash[6U];
      uint32_t h02 = hash[7U];
      uint32_t k_e_t = k_t;
      uint32_t
      t1 =
        h02
        + ((e0 << 26U | e0 >> 6U) ^ ((e0 << 21U | e0 >> 11U) ^ (e0 << 7U | e0 >> 25U)))
        + ((e0 & f0) ^ (~e0 & g0))
        + k_e_t
        + ws_t;
      uint32_t
      t2 =
        ((a0 << 30U | a0 >> 2U) ^ ((a0 << 19U | a0 >> 13U) ^ (a0 << 10U | a0 >> 22U)))
        + ((a0 & b0) ^ ((a0 & c0) ^ (b0 & c0)));
      uint32_t a1 = t1 + t2;
      uint32_t b1 = a0;
      uint32_t c1 = b0;
      uint32_t d1 = c0;
      uint32_t e1 = d0 + t1;
      uint32_t f1 = e0;
      uint32_t g1 = f0;
      uint32_t h12 = g0;
      hash[0U] = a1;
      hash[1U] = b1;
      hash[2U] = c1;
      hash[3U] = d1;
      hash[4U] = e1;
      hash[5U] = f1;
      hash[6U] = g1;
      hash[7U] = h12;
    }
    if (i0 < 3U)
      for (uint32_t i = 0U; i < 16U; i++)
      {
        uint32_t t16 = ws[i];
        uint32_t t15 = ws[(i + 1U) % 16U];
        uint32_t t7 = ws[(i + 9U) % 16U];
        uint32_t t2 = ws[(i + 14U) % 16U];
        uint32_t s1 = (t2 << 15U | t2 >> 17U) ^ ((t2 << 13U | t2 >> 19U) ^ t2 >> 10U);
        uint32_t s0 = (t15 << 25U | t15 >> 7U) ^ ((t15 << 14U | t15 >> 18U) ^ t15 >> 3U);
        ws[i] = s1 + t7 + s0 + t16;
      }
  }
  for (uint32_t i = 0U; i < 8U; i++)
  {
    uint32_t *os = hash;
    uint32_t x = hash[i] + hash_old[i];
    os[i] = x;
  }
}

static void sha256_update_nblocks(uint32_t len, uint8_t *b, uint32_t *st)
{
  uint32_t blocks = len / 64U;
  for (uint32_t i = 0U; i < blocks; i++)
  {
    uint8_t *b0 = b;
    uint8_t *mb = b0 + i * 64U;
    sha256_update(mb, st);
  }
}

static void
sha256_update_last(uint64_t totlen, uint32_t len, uint8_t *b, uint32_t *hash)
{
  uint32_t blocks;
  if (len + 8U + 1U <= 64U)
    blocks = 1U;
  else
    blocks = 2U;
  uint32_t fin = blocks * 64U;
  uint8_t last[128U] = { 0U };
  uint8_t totlen_buf[8U] = { 0U };
  uint64_t total_len_bits = totlen << 3U;
  store64_be(totlen_buf, total_len_bits);
  uint8_t *b0 = b;
  memcpy(last, b0, len * sizeof (uint8_t));
  last[len] = 0x80U;
  memcpy(last + fin - 8U, totlen_buf, 8U * sizeof (uint8_t));
  uint8_t *last00 = last;
  uint8_t *last10 = last + 64U;
  uint8_t *l0 = last00;
  uint8_t *l1 = last10;
  uint8_t *lb0 = l0;
  uint8_t *lb1 = l1;
  uint8_t *last0 = lb0;
  uint8_t *last1 = lb1;
  sha256_update(last0, hash);
  if (blocks > 1U)
    sha256_update(last1, hash);
}

static void sha256_finish(uint32_t *st, uint8_t *h)
{
  uint8_t hbuf[32U] = { 0U };
  for (uint32_t i = 0U; i < 8U; i++)
    store32_be(hbuf + i * 4U, st[i]);
  memcpy(h, hbuf, 32U * sizeof (uint8_t));
}

/*
extern uint64_t
Lib_IntTypes_Intrinsics_add_carry_u64(uint64_t uu___, uint64_t x0, uint64_t x1, uint64_t *x2);

extern uint64_t
Lib_IntTypes_Intrinsics_sub_borrow_u64(uint64_t uu___, uint64_t x0, uint64_t x1, uint64_t *x2);
*/

static uint64_t mul_wide_add2_u64(uint64_t a, uint64_t b, uint64_t c_in, uint64_t *out)
{
  uint64_t out0 = out[0U];
  FStar_UInt128_uint128
  res =
    FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_mul_wide(a, b),
        FStar_UInt128_uint64_to_uint128(c_in)),
      FStar_UInt128_uint64_to_uint128(out0));
  out[0U] = FStar_UInt128_uint128_to_uint64(res);
  return FStar_UInt128_uint128_to_uint64(FStar_UInt128_shift_right(res, 64U));
}

static uint64_t bn_get_bits_u64(uint32_t len, uint64_t *b, uint32_t i, uint32_t l)
{
  uint32_t i1 = i / 64U;
  uint32_t j = i % 64U;
  uint64_t p1 = b[i1] >> j;
  uint64_t ite;
  if (i1 + 1U < len && 0U < j)
    ite = p1 | b[i1 + 1U] << (64U - j);
  else
    ite = p1;
  return ite & ((1ULL << l) - 1ULL);
}

static uint64_t bn_add_eq_len_u64(uint32_t aLen, uint64_t *a, uint64_t *b, uint64_t *res)
{
  uint64_t c = 0ULL;
  for (uint32_t i = 0U; i < aLen / 4U; i++)
  {
    uint64_t t1 = a[4U * i];
    uint64_t t20 = b[4U * i];
    uint64_t *res_i0 = res + 4U * i;
    c = Lib_IntTypes_Intrinsics_add_carry_u64(c, t1, t20, res_i0);
    uint64_t t10 = a[4U * i + 1U];
    uint64_t t21 = b[4U * i + 1U];
    uint64_t *res_i1 = res + 4U * i + 1U;
    c = Lib_IntTypes_Intrinsics_add_carry_u64(c, t10, t21, res_i1);
    uint64_t t11 = a[4U * i + 2U];
    uint64_t t22 = b[4U * i + 2U];
    uint64_t *res_i2 = res + 4U * i + 2U;
    c = Lib_IntTypes_Intrinsics_add_carry_u64(c, t11, t22, res_i2);
    uint64_t t12 = a[4U * i + 3U];
    uint64_t t2 = b[4U * i + 3U];
    uint64_t *res_i = res + 4U * i + 3U;
    c = Lib_IntTypes_Intrinsics_add_carry_u64(c, t12, t2, res_i);
  }
  for (uint32_t i = aLen / 4U * 4U; i < aLen; i++)
  {
    uint64_t t1 = a[i];
    uint64_t t2 = b[i];
    uint64_t *res_i = res + i;
    c = Lib_IntTypes_Intrinsics_add_carry_u64(c, t1, t2, res_i);
  }
  return c;
}

static uint64_t bn_is_zero_mask4(uint64_t *f)
{
  uint64_t bn_zero[4U] = { 0U };
  uint64_t mask = 0xFFFFFFFFFFFFFFFFULL;
  for (uint32_t i = 0U; i < 4U; i++)
  {
    uint64_t uu____0 = FStar_UInt64_eq_mask(f[i], bn_zero[i]);
    mask = uu____0 & mask;
  }
  uint64_t mask1 = mask;
  uint64_t res = mask1;
  return res;
}

static void bn_cmovznz4(uint64_t *res, uint64_t cin, uint64_t *x, uint64_t *y)
{
  uint64_t mask = ~FStar_UInt64_eq_mask(cin, 0ULL);
  for (uint32_t i = 0U; i < 4U; i++)
  {
    uint64_t *os = res;
    uint64_t uu____0 = x[i];
    uint64_t x1 = uu____0 ^ (mask & (y[i] ^ uu____0));
    os[i] = x1;
  }
}

static void bn_add_mod4(uint64_t *res, uint64_t *n, uint64_t *x, uint64_t *y)
{
  uint64_t c0 = 0ULL;
  for (uint32_t i = 0U; i < 1U; i++)
  {
    uint64_t t1 = x[4U * i];
    uint64_t t20 = y[4U * i];
    uint64_t *res_i0 = res + 4U * i;
    c0 = Lib_IntTypes_Intrinsics_add_carry_u64(c0, t1, t20, res_i0);
    uint64_t t10 = x[4U * i + 1U];
    uint64_t t21 = y[4U * i + 1U];
    uint64_t *res_i1 = res + 4U * i + 1U;
    c0 = Lib_IntTypes_Intrinsics_add_carry_u64(c0, t10, t21, res_i1);
    uint64_t t11 = x[4U * i + 2U];
    uint64_t t22 = y[4U * i + 2U];
    uint64_t *res_i2 = res + 4U * i + 2U;
    c0 = Lib_IntTypes_Intrinsics_add_carry_u64(c0, t11, t22, res_i2);
    uint64_t t12 = x[4U * i + 3U];
    uint64_t t2 = y[4U * i + 3U];
    uint64_t *res_i = res + 4U * i + 3U;
    c0 = Lib_IntTypes_Intrinsics_add_carry_u64(c0, t12, t2, res_i);
  }
  for (uint32_t i = 4U; i < 4U; i++)
  {
    uint64_t t1 = x[i];
    uint64_t t2 = y[i];
    uint64_t *res_i = res + i;
    c0 = Lib_IntTypes_Intrinsics_add_carry_u64(c0, t1, t2, res_i);
  }
  uint64_t c00 = c0;
  uint64_t tmp[4U] = { 0U };
  uint64_t c = 0ULL;
  for (uint32_t i = 0U; i < 1U; i++)
  {
    uint64_t t1 = res[4U * i];
    uint64_t t20 = n[4U * i];
    uint64_t *res_i0 = tmp + 4U * i;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t1, t20, res_i0);
    uint64_t t10 = res[4U * i + 1U];
    uint64_t t21 = n[4U * i + 1U];
    uint64_t *res_i1 = tmp + 4U * i + 1U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t10, t21, res_i1);
    uint64_t t11 = res[4U * i + 2U];
    uint64_t t22 = n[4U * i + 2U];
    uint64_t *res_i2 = tmp + 4U * i + 2U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t11, t22, res_i2);
    uint64_t t12 = res[4U * i + 3U];
    uint64_t t2 = n[4U * i + 3U];
    uint64_t *res_i = tmp + 4U * i + 3U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t12, t2, res_i);
  }
  for (uint32_t i = 4U; i < 4U; i++)
  {
    uint64_t t1 = res[i];
    uint64_t t2 = n[i];
    uint64_t *res_i = tmp + i;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t1, t2, res_i);
  }
  uint64_t c1 = c;
  uint64_t c2 = c00 - c1;
  for (uint32_t i = 0U; i < 4U; i++)
  {
    uint64_t *os = res;
    uint64_t x1 = (c2 & res[i]) | (~c2 & tmp[i]);
    os[i] = x1;
  }
}

static uint64_t bn_sub4(uint64_t *res, uint64_t *x, uint64_t *y)
{
  uint64_t c = 0ULL;
  for (uint32_t i = 0U; i < 1U; i++)
  {
    uint64_t t1 = x[4U * i];
    uint64_t t20 = y[4U * i];
    uint64_t *res_i0 = res + 4U * i;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t1, t20, res_i0);
    uint64_t t10 = x[4U * i + 1U];
    uint64_t t21 = y[4U * i + 1U];
    uint64_t *res_i1 = res + 4U * i + 1U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t10, t21, res_i1);
    uint64_t t11 = x[4U * i + 2U];
    uint64_t t22 = y[4U * i + 2U];
    uint64_t *res_i2 = res + 4U * i + 2U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t11, t22, res_i2);
    uint64_t t12 = x[4U * i + 3U];
    uint64_t t2 = y[4U * i + 3U];
    uint64_t *res_i = res + 4U * i + 3U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t12, t2, res_i);
  }
  for (uint32_t i = 4U; i < 4U; i++)
  {
    uint64_t t1 = x[i];
    uint64_t t2 = y[i];
    uint64_t *res_i = res + i;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t1, t2, res_i);
  }
  uint64_t c0 = c;
  return c0;
}

static void bn_sub_mod4(uint64_t *res, uint64_t *n, uint64_t *x, uint64_t *y)
{
  uint64_t c0 = 0ULL;
  for (uint32_t i = 0U; i < 1U; i++)
  {
    uint64_t t1 = x[4U * i];
    uint64_t t20 = y[4U * i];
    uint64_t *res_i0 = res + 4U * i;
    c0 = Lib_IntTypes_Intrinsics_sub_borrow_u64(c0, t1, t20, res_i0);
    uint64_t t10 = x[4U * i + 1U];
    uint64_t t21 = y[4U * i + 1U];
    uint64_t *res_i1 = res + 4U * i + 1U;
    c0 = Lib_IntTypes_Intrinsics_sub_borrow_u64(c0, t10, t21, res_i1);
    uint64_t t11 = x[4U * i + 2U];
    uint64_t t22 = y[4U * i + 2U];
    uint64_t *res_i2 = res + 4U * i + 2U;
    c0 = Lib_IntTypes_Intrinsics_sub_borrow_u64(c0, t11, t22, res_i2);
    uint64_t t12 = x[4U * i + 3U];
    uint64_t t2 = y[4U * i + 3U];
    uint64_t *res_i = res + 4U * i + 3U;
    c0 = Lib_IntTypes_Intrinsics_sub_borrow_u64(c0, t12, t2, res_i);
  }
  for (uint32_t i = 4U; i < 4U; i++)
  {
    uint64_t t1 = x[i];
    uint64_t t2 = y[i];
    uint64_t *res_i = res + i;
    c0 = Lib_IntTypes_Intrinsics_sub_borrow_u64(c0, t1, t2, res_i);
  }
  uint64_t c00 = c0;
  uint64_t tmp[4U] = { 0U };
  uint64_t c = 0ULL;
  for (uint32_t i = 0U; i < 1U; i++)
  {
    uint64_t t1 = res[4U * i];
    uint64_t t20 = n[4U * i];
    uint64_t *res_i0 = tmp + 4U * i;
    c = Lib_IntTypes_Intrinsics_add_carry_u64(c, t1, t20, res_i0);
    uint64_t t10 = res[4U * i + 1U];
    uint64_t t21 = n[4U * i + 1U];
    uint64_t *res_i1 = tmp + 4U * i + 1U;
    c = Lib_IntTypes_Intrinsics_add_carry_u64(c, t10, t21, res_i1);
    uint64_t t11 = res[4U * i + 2U];
    uint64_t t22 = n[4U * i + 2U];
    uint64_t *res_i2 = tmp + 4U * i + 2U;
    c = Lib_IntTypes_Intrinsics_add_carry_u64(c, t11, t22, res_i2);
    uint64_t t12 = res[4U * i + 3U];
    uint64_t t2 = n[4U * i + 3U];
    uint64_t *res_i = tmp + 4U * i + 3U;
    c = Lib_IntTypes_Intrinsics_add_carry_u64(c, t12, t2, res_i);
  }
  for (uint32_t i = 4U; i < 4U; i++)
  {
    uint64_t t1 = res[i];
    uint64_t t2 = n[i];
    uint64_t *res_i = tmp + i;
    c = Lib_IntTypes_Intrinsics_add_carry_u64(c, t1, t2, res_i);
  }
  uint64_t c1 = c;
  KRML_MAYBE_UNUSED_VAR(c1);
  uint64_t c2 = 0ULL - c00;
  for (uint32_t i = 0U; i < 4U; i++)
  {
    uint64_t *os = res;
    uint64_t x1 = (c2 & tmp[i]) | (~c2 & res[i]);
    os[i] = x1;
  }
}

static void bn_mul4(uint64_t *res, uint64_t *x, uint64_t *y)
{
  memset(res, 0U, 8U * sizeof (uint64_t));
  for (uint32_t i0 = 0U; i0 < 4U; i0++)
  {
    uint64_t bj = y[i0];
    uint64_t *res_j = res + i0;
    uint64_t c = 0ULL;
    for (uint32_t i = 0U; i < 1U; i++)
    {
      uint64_t a_i = x[4U * i];
      uint64_t *res_i0 = res_j + 4U * i;
      c = mul_wide_add2_u64(a_i, bj, c, res_i0);
      uint64_t a_i0 = x[4U * i + 1U];
      uint64_t *res_i1 = res_j + 4U * i + 1U;
      c = mul_wide_add2_u64(a_i0, bj, c, res_i1);
      uint64_t a_i1 = x[4U * i + 2U];
      uint64_t *res_i2 = res_j + 4U * i + 2U;
      c = mul_wide_add2_u64(a_i1, bj, c, res_i2);
      uint64_t a_i2 = x[4U * i + 3U];
      uint64_t *res_i = res_j + 4U * i + 3U;
      c = mul_wide_add2_u64(a_i2, bj, c, res_i);
    }
    for (uint32_t i = 4U; i < 4U; i++)
    {
      uint64_t a_i = x[i];
      uint64_t *res_i = res_j + i;
      c = mul_wide_add2_u64(a_i, bj, c, res_i);
    }
    uint64_t r = c;
    res[4U + i0] = r;
  }
}

static void bn_sqr4(uint64_t *res, uint64_t *x)
{
  memset(res, 0U, 8U * sizeof (uint64_t));
  for (uint32_t i0 = 0U; i0 < 4U; i0++)
  {
    uint64_t *ab = x;
    uint64_t a_j = x[i0];
    uint64_t *res_j = res + i0;
    uint64_t c = 0ULL;
    for (uint32_t i = 0U; i < i0 / 4U; i++)
    {
      uint64_t a_i = ab[4U * i];
      uint64_t *res_i0 = res_j + 4U * i;
      c = mul_wide_add2_u64(a_i, a_j, c, res_i0);
      uint64_t a_i0 = ab[4U * i + 1U];
      uint64_t *res_i1 = res_j + 4U * i + 1U;
      c = mul_wide_add2_u64(a_i0, a_j, c, res_i1);
      uint64_t a_i1 = ab[4U * i + 2U];
      uint64_t *res_i2 = res_j + 4U * i + 2U;
      c = mul_wide_add2_u64(a_i1, a_j, c, res_i2);
      uint64_t a_i2 = ab[4U * i + 3U];
      uint64_t *res_i = res_j + 4U * i + 3U;
      c = mul_wide_add2_u64(a_i2, a_j, c, res_i);
    }
    for (uint32_t i = i0 / 4U * 4U; i < i0; i++)
    {
      uint64_t a_i = ab[i];
      uint64_t *res_i = res_j + i;
      c = mul_wide_add2_u64(a_i, a_j, c, res_i);
    }
    uint64_t r = c;
    res[i0 + i0] = r;
  }
  uint64_t c0 = bn_add_eq_len_u64(8U, res, res, res);
  KRML_MAYBE_UNUSED_VAR(c0);
  uint64_t tmp[8U] = { 0U };
  for (uint32_t i = 0U; i < 4U; i++)
  {
    FStar_UInt128_uint128 res1 = FStar_UInt128_mul_wide(x[i], x[i]);
    uint64_t hi = FStar_UInt128_uint128_to_uint64(FStar_UInt128_shift_right(res1, 64U));
    uint64_t lo = FStar_UInt128_uint128_to_uint64(res1);
    tmp[2U * i] = lo;
    tmp[2U * i + 1U] = hi;
  }
  uint64_t c1 = bn_add_eq_len_u64(8U, res, tmp, res);
  KRML_MAYBE_UNUSED_VAR(c1);
}

static void bn_to_bytes_be4(uint8_t *res, uint64_t *f)
{
  uint8_t tmp[32U] = { 0U };
  KRML_MAYBE_UNUSED_VAR(tmp);
  for (uint32_t i = 0U; i < 4U; i++)
    store64_be(res + i * 8U, f[4U - i - 1U]);
}

static void bn_from_bytes_be4(uint64_t *res, uint8_t *b)
{
  for (uint32_t i = 0U; i < 4U; i++)
  {
    uint64_t *os = res;
    uint64_t u = load64_be(b + (4U - i - 1U) * 8U);
    uint64_t x = u;
    os[i] = x;
  }
}

static void bn2_to_bytes_be4(uint8_t *res, uint64_t *x, uint64_t *y)
{
  bn_to_bytes_be4(res, x);
  bn_to_bytes_be4(res + 32U, y);
}

static void make_prime(uint64_t *n)
{
  n[0U] = 0xffffffffffffffffULL;
  n[1U] = 0xffffffffULL;
  n[2U] = 0x0ULL;
  n[3U] = 0xffffffff00000001ULL;
}

static void make_order(uint64_t *n)
{
  n[0U] = 0xf3b9cac2fc632551ULL;
  n[1U] = 0xbce6faada7179e84ULL;
  n[2U] = 0xffffffffffffffffULL;
  n[3U] = 0xffffffff00000000ULL;
}

static void make_b_coeff(uint64_t *b)
{
  b[0U] = 0xd89cdf6229c4bddfULL;
  b[1U] = 0xacf005cd78843090ULL;
  b[2U] = 0xe5a220abf7212ed6ULL;
  b[3U] = 0xdc30061d04874834ULL;
}

static void make_g_x(uint64_t *n)
{
  n[0U] = 0x79e730d418a9143cULL;
  n[1U] = 0x75ba95fc5fedb601ULL;
  n[2U] = 0x79fb732b77622510ULL;
  n[3U] = 0x18905f76a53755c6ULL;
}

static void make_g_y(uint64_t *n)
{
  n[0U] = 0xddf25357ce95560aULL;
  n[1U] = 0x8b4ab8e4ba19e45cULL;
  n[2U] = 0xd2e88688dd21f325ULL;
  n[3U] = 0x8571ff1825885d85ULL;
}

static void make_fzero(uint64_t *n)
{
  n[0U] = 0ULL;
  n[1U] = 0ULL;
  n[2U] = 0ULL;
  n[3U] = 0ULL;
}

static void make_fone(uint64_t *n)
{
  n[0U] = 0x1ULL;
  n[1U] = 0xffffffff00000000ULL;
  n[2U] = 0xffffffffffffffffULL;
  n[3U] = 0xfffffffeULL;
}

static void fadd(uint64_t *res, uint64_t *x, uint64_t *y)
{
  uint64_t n[4U] = { 0U };
  make_prime(n);
  bn_add_mod4(res, n, x, y);
}

static void fsub(uint64_t *res, uint64_t *x, uint64_t *y)
{
  uint64_t n[4U] = { 0U };
  make_prime(n);
  bn_sub_mod4(res, n, x, y);
}

static void mont_reduction(uint64_t *res, uint64_t *x)
{
  uint64_t n[4U] = { 0U };
  make_prime(n);
  uint64_t c0 = 0ULL;
  for (uint32_t i0 = 0U; i0 < 4U; i0++)
  {
    uint64_t qj = 1ULL * x[i0];
    uint64_t *res_j0 = x + i0;
    uint64_t c = 0ULL;
    for (uint32_t i = 0U; i < 1U; i++)
    {
      uint64_t a_i = n[4U * i];
      uint64_t *res_i0 = res_j0 + 4U * i;
      c = mul_wide_add2_u64(a_i, qj, c, res_i0);
      uint64_t a_i0 = n[4U * i + 1U];
      uint64_t *res_i1 = res_j0 + 4U * i + 1U;
      c = mul_wide_add2_u64(a_i0, qj, c, res_i1);
      uint64_t a_i1 = n[4U * i + 2U];
      uint64_t *res_i2 = res_j0 + 4U * i + 2U;
      c = mul_wide_add2_u64(a_i1, qj, c, res_i2);
      uint64_t a_i2 = n[4U * i + 3U];
      uint64_t *res_i = res_j0 + 4U * i + 3U;
      c = mul_wide_add2_u64(a_i2, qj, c, res_i);
    }
    for (uint32_t i = 4U; i < 4U; i++)
    {
      uint64_t a_i = n[i];
      uint64_t *res_i = res_j0 + i;
      c = mul_wide_add2_u64(a_i, qj, c, res_i);
    }
    uint64_t r = c;
    uint64_t c1 = r;
    uint64_t *resb = x + 4U + i0;
    uint64_t res_j = x[4U + i0];
    c0 = Lib_IntTypes_Intrinsics_add_carry_u64(c0, c1, res_j, resb);
  }
  memcpy(res, x + 4U, 4U * sizeof (uint64_t));
  uint64_t c00 = c0;
  uint64_t tmp[4U] = { 0U };
  uint64_t c = 0ULL;
  for (uint32_t i = 0U; i < 1U; i++)
  {
    uint64_t t1 = res[4U * i];
    uint64_t t20 = n[4U * i];
    uint64_t *res_i0 = tmp + 4U * i;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t1, t20, res_i0);
    uint64_t t10 = res[4U * i + 1U];
    uint64_t t21 = n[4U * i + 1U];
    uint64_t *res_i1 = tmp + 4U * i + 1U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t10, t21, res_i1);
    uint64_t t11 = res[4U * i + 2U];
    uint64_t t22 = n[4U * i + 2U];
    uint64_t *res_i2 = tmp + 4U * i + 2U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t11, t22, res_i2);
    uint64_t t12 = res[4U * i + 3U];
    uint64_t t2 = n[4U * i + 3U];
    uint64_t *res_i = tmp + 4U * i + 3U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t12, t2, res_i);
  }
  for (uint32_t i = 4U; i < 4U; i++)
  {
    uint64_t t1 = res[i];
    uint64_t t2 = n[i];
    uint64_t *res_i = tmp + i;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t1, t2, res_i);
  }
  uint64_t c1 = c;
  uint64_t c2 = c00 - c1;
  for (uint32_t i = 0U; i < 4U; i++)
  {
    uint64_t *os = res;
    uint64_t x1 = (c2 & res[i]) | (~c2 & tmp[i]);
    os[i] = x1;
  }
}

static void fmul(uint64_t *res, uint64_t *x, uint64_t *y)
{
  uint64_t tmp[8U] = { 0U };
  bn_mul4(tmp, x, y);
  mont_reduction(res, tmp);
}

static void fsqr(uint64_t *res, uint64_t *x)
{
  uint64_t tmp[8U] = { 0U };
  bn_sqr4(tmp, x);
  mont_reduction(res, tmp);
}

static void from_mont(uint64_t *res, uint64_t *a)
{
  uint64_t tmp[8U] = { 0U };
  memcpy(tmp, a, 4U * sizeof (uint64_t));
  mont_reduction(res, tmp);
}

static void fmul_by_b_coeff(uint64_t *res, uint64_t *x)
{
  uint64_t b_coeff[4U] = { 0U };
  make_b_coeff(b_coeff);
  fmul(res, b_coeff, x);
}

static void finv(uint64_t *res, uint64_t *a)
{
  uint64_t tmp[16U] = { 0U };
  uint64_t *x30 = tmp;
  uint64_t *x2 = tmp + 4U;
  uint64_t *tmp1 = tmp + 8U;
  uint64_t *tmp2 = tmp + 12U;
  memcpy(x2, a, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 1U; i++)
    fsqr(x2, x2);
  fmul(x2, x2, a);
  memcpy(x30, x2, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 1U; i++)
    fsqr(x30, x30);
  fmul(x30, x30, a);
  memcpy(tmp1, x30, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 3U; i++)
    fsqr(tmp1, tmp1);
  fmul(tmp1, tmp1, x30);
  memcpy(tmp2, tmp1, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 6U; i++)
    fsqr(tmp2, tmp2);
  fmul(tmp2, tmp2, tmp1);
  memcpy(tmp1, tmp2, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 3U; i++)
    fsqr(tmp1, tmp1);
  fmul(tmp1, tmp1, x30);
  memcpy(x30, tmp1, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 15U; i++)
    fsqr(x30, x30);
  fmul(x30, x30, tmp1);
  memcpy(tmp1, x30, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 2U; i++)
    fsqr(tmp1, tmp1);
  fmul(tmp1, tmp1, x2);
  memcpy(x2, tmp1, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 32U; i++)
    fsqr(x2, x2);
  fmul(x2, x2, a);
  for (uint32_t i = 0U; i < 128U; i++)
    fsqr(x2, x2);
  fmul(x2, x2, tmp1);
  for (uint32_t i = 0U; i < 32U; i++)
    fsqr(x2, x2);
  fmul(x2, x2, tmp1);
  for (uint32_t i = 0U; i < 30U; i++)
    fsqr(x2, x2);
  fmul(x2, x2, x30);
  for (uint32_t i = 0U; i < 2U; i++)
    fsqr(x2, x2);
  fmul(tmp1, x2, a);
  memcpy(res, tmp1, 4U * sizeof (uint64_t));
}

static void make_base_point(uint64_t *p)
{
  uint64_t *x = p;
  uint64_t *y = p + 4U;
  uint64_t *z = p + 8U;
  make_g_x(x);
  make_g_y(y);
  make_fone(z);
}

static void make_point_at_inf(uint64_t *p)
{
  uint64_t *x = p;
  uint64_t *y = p + 4U;
  uint64_t *z = p + 8U;
  make_fzero(x);
  make_fone(y);
  make_fzero(z);
}

static void to_aff_point_x(uint64_t *res, uint64_t *p)
{
  uint64_t zinv[4U] = { 0U };
  uint64_t *px = p;
  uint64_t *pz = p + 8U;
  finv(zinv, pz);
  fmul(res, px, zinv);
  from_mont(res, res);
}

static void point_double(uint64_t *res, uint64_t *p)
{
  uint64_t tmp[20U] = { 0U };
  uint64_t *x = p;
  uint64_t *z = p + 8U;
  uint64_t *x3 = res;
  uint64_t *y3 = res + 4U;
  uint64_t *z3 = res + 8U;
  uint64_t *t0 = tmp;
  uint64_t *t1 = tmp + 4U;
  uint64_t *t2 = tmp + 8U;
  uint64_t *t3 = tmp + 12U;
  uint64_t *t4 = tmp + 16U;
  uint64_t *x1 = p;
  uint64_t *y = p + 4U;
  uint64_t *z1 = p + 8U;
  fsqr(t0, x1);
  fsqr(t1, y);
  fsqr(t2, z1);
  fmul(t3, x1, y);
  fadd(t3, t3, t3);
  fmul(t4, y, z1);
  fmul(z3, x, z);
  fadd(z3, z3, z3);
  fmul_by_b_coeff(y3, t2);
  fsub(y3, y3, z3);
  fadd(x3, y3, y3);
  fadd(y3, x3, y3);
  fsub(x3, t1, y3);
  fadd(y3, t1, y3);
  fmul(y3, x3, y3);
  fmul(x3, x3, t3);
  fadd(t3, t2, t2);
  fadd(t2, t2, t3);
  fmul_by_b_coeff(z3, z3);
  fsub(z3, z3, t2);
  fsub(z3, z3, t0);
  fadd(t3, z3, z3);
  fadd(z3, z3, t3);
  fadd(t3, t0, t0);
  fadd(t0, t3, t0);
  fsub(t0, t0, t2);
  fmul(t0, t0, z3);
  fadd(y3, y3, t0);
  fadd(t0, t4, t4);
  fmul(z3, t0, z3);
  fsub(x3, x3, z3);
  fmul(z3, t0, t1);
  fadd(z3, z3, z3);
  fadd(z3, z3, z3);
}

static void point_add(uint64_t *res, uint64_t *p, uint64_t *q)
{
  uint64_t tmp[36U] = { 0U };
  uint64_t *t0 = tmp;
  uint64_t *t1 = tmp + 24U;
  uint64_t *x3 = t1;
  uint64_t *y3 = t1 + 4U;
  uint64_t *z3 = t1 + 8U;
  uint64_t *t01 = t0;
  uint64_t *t11 = t0 + 4U;
  uint64_t *t2 = t0 + 8U;
  uint64_t *t3 = t0 + 12U;
  uint64_t *t4 = t0 + 16U;
  uint64_t *t5 = t0 + 20U;
  uint64_t *x1 = p;
  uint64_t *y1 = p + 4U;
  uint64_t *z10 = p + 8U;
  uint64_t *x20 = q;
  uint64_t *y20 = q + 4U;
  uint64_t *z20 = q + 8U;
  fmul(t01, x1, x20);
  fmul(t11, y1, y20);
  fmul(t2, z10, z20);
  fadd(t3, x1, y1);
  fadd(t4, x20, y20);
  fmul(t3, t3, t4);
  fadd(t4, t01, t11);
  uint64_t *y10 = p + 4U;
  uint64_t *z11 = p + 8U;
  uint64_t *y2 = q + 4U;
  uint64_t *z21 = q + 8U;
  fsub(t3, t3, t4);
  fadd(t4, y10, z11);
  fadd(t5, y2, z21);
  fmul(t4, t4, t5);
  fadd(t5, t11, t2);
  fsub(t4, t4, t5);
  uint64_t *x10 = p;
  uint64_t *z1 = p + 8U;
  uint64_t *x2 = q;
  uint64_t *z2 = q + 8U;
  fadd(x3, x10, z1);
  fadd(y3, x2, z2);
  fmul(x3, x3, y3);
  fadd(y3, t01, t2);
  fsub(y3, x3, y3);
  fmul_by_b_coeff(z3, t2);
  fsub(x3, y3, z3);
  fadd(z3, x3, x3);
  fadd(x3, x3, z3);
  fsub(z3, t11, x3);
  fadd(x3, t11, x3);
  fmul_by_b_coeff(y3, y3);
  fadd(t11, t2, t2);
  fadd(t2, t11, t2);
  fsub(y3, y3, t2);
  fsub(y3, y3, t01);
  fadd(t11, y3, y3);
  fadd(y3, t11, y3);
  fadd(t11, t01, t01);
  fadd(t01, t11, t01);
  fsub(t01, t01, t2);
  fmul(t11, t4, y3);
  fmul(t2, t01, y3);
  fmul(y3, x3, z3);
  fadd(y3, y3, t2);
  fmul(x3, t3, x3);
  fsub(x3, x3, t11);
  fmul(z3, t4, z3);
  fmul(t11, t3, t01);
  fadd(z3, z3, t11);
  memcpy(res, t1, 12U * sizeof (uint64_t));
}

static const
uint64_t
precomp_basepoint_table_w4[192U] =
  {
    0ULL, 0ULL, 0ULL, 0ULL, 1ULL, 18446744069414584320ULL, 18446744073709551615ULL, 4294967294ULL,
    0ULL, 0ULL, 0ULL, 0ULL, 8784043285714375740ULL, 8483257759279461889ULL, 8789745728267363600ULL,
    1770019616739251654ULL, 15992936863339206154ULL, 10037038012062884956ULL,
    15197544864945402661ULL, 9615747158586711429ULL, 1ULL, 18446744069414584320ULL,
    18446744073709551615ULL, 4294967294ULL, 10634854829044225757ULL, 351552716085025155ULL,
    10645315080955407736ULL, 3609262091244858135ULL, 15760741698986874125ULL,
    14936374388219697827ULL, 15751360096993017895ULL, 18012233706239762398ULL,
    1993877568177495041ULL, 10345888787846536528ULL, 7746511691117935375ULL,
    14517043990409914413ULL, 14122549297570634151ULL, 16934610359517083771ULL,
    5724511325497097418ULL, 8983432969107448705ULL, 2687429970334080245ULL, 16525396802810050288ULL,
    7602596488871585854ULL, 4813919589149203084ULL, 7680395813780804519ULL, 6687709583048023590ULL,
    18086445169104142027ULL, 9637814708330203929ULL, 14785108459960679090ULL,
    3838023279095023581ULL, 3555615526157830307ULL, 5177066488380472871ULL, 18218186719108038403ULL,
    16281556341699656105ULL, 1524227924561461191ULL, 4148060517641909597ULL, 2858290374115363433ULL,
    8942772026334130620ULL, 3034451298319885113ULL, 8447866036736640940ULL, 11204933433076256578ULL,
    18333595740249588297ULL, 8259597024804538246ULL, 9539734295777539786ULL, 9797290423046626413ULL,
    5777303437849646537ULL, 8739356909899132020ULL, 14815960973766782158ULL,
    15286581798204509801ULL, 17597362577777019682ULL, 13259283710820519742ULL,
    10501322996899164670ULL, 1221138904338319642ULL, 14586685489551951885ULL, 895326705426031212ULL,
    14398171728560617847ULL, 9592550823745097391ULL, 17240998489162206026ULL,
    8085479283308189196ULL, 14844657737893882826ULL, 15923425394150618234ULL,
    2997808084773249525ULL, 494323555453660587ULL, 1215695327517794764ULL, 9476207381098391690ULL,
    7480789678419122995ULL, 15212230329321082489ULL, 436189395349576388ULL, 17377474396456660834ULL,
    15237013929655017939ULL, 11444428846883781676ULL, 5112749694521428575ULL, 950829367509872073ULL,
    17665036182057559519ULL, 17205133339690002313ULL, 16233765170251334549ULL,
    10122775683257972591ULL, 3352514236455632420ULL, 9143148522359954691ULL, 601191684005658860ULL,
    13398772186646349998ULL, 15512696600132928431ULL, 9128416073728948653ULL,
    11233051033546138578ULL, 6769345682610122833ULL, 10823233224575054288ULL,
    9997725227559980175ULL, 6733425642852897415ULL, 16302206918151466066ULL, 1669330822143265921ULL,
    2661645605036546002ULL, 17182558479745802165ULL, 1165082692376932040ULL, 9470595929011488359ULL,
    6142147329285324932ULL, 4829075085998111287ULL, 10231370681107338930ULL, 9591876895322495239ULL,
    10316468561384076618ULL, 11592503647238064235ULL, 13395813606055179632ULL,
    511127033980815508ULL, 12434976573147649880ULL, 3425094795384359127ULL, 6816971736303023445ULL,
    15444670609021139344ULL, 9464349818322082360ULL, 16178216413042376883ULL,
    9595540370774317348ULL, 7229365182662875710ULL, 4601177649460012843ULL, 5455046447382487090ULL,
    10854066421606187521ULL, 15913416821879788071ULL, 2297365362023460173ULL,
    2603252216454941350ULL, 6768791943870490934ULL, 15705936687122754810ULL, 9537096567546600694ULL,
    17580538144855035062ULL, 4496542856965746638ULL, 8444341625922124942ULL,
    12191263903636183168ULL, 17427332907535974165ULL, 14307569739254103736ULL,
    13900598742063266169ULL, 7176996424355977650ULL, 5709008170379717479ULL,
    14471312052264549092ULL, 1464519909491759867ULL, 3328154641049602121ULL,
    13020349337171136774ULL, 2772166279972051938ULL, 10854476939425975292ULL,
    1967189930534630940ULL, 2802919076529341959ULL, 14792226094833519208ULL,
    14675640928566522177ULL, 14838974364643800837ULL, 17631460696099549980ULL,
    17434186275364935469ULL, 2665648200587705473ULL, 13202122464492564051ULL,
    7576287350918073341ULL, 2272206013910186424ULL, 14558761641743937843ULL, 5675729149929979729ULL,
    9043135187561613166ULL, 11750149293830589225ULL, 740555197954307911ULL, 9871738005087190699ULL,
    17178667634283502053ULL, 18046255991533013265ULL, 4458222096988430430ULL,
    8452427758526311627ULL, 13825286929656615266ULL, 13956286357198391218ULL,
    15875692916799995079ULL, 10634895319157013920ULL, 13230116118036304207ULL,
    8795317393614625606ULL, 7001710806858862020ULL, 7949746088586183478ULL, 14677556044923602317ULL,
    11184023437485843904ULL, 11215864722023085094ULL, 6444464081471519014ULL,
    1706241174022415217ULL, 8243975633057550613ULL, 15502902453836085864ULL, 3799182188594003953ULL,
    3538840175098724094ULL
  };

static const
uint64_t
precomp_g_pow2_64_table_w4[192U] =
  {
    0ULL, 0ULL, 0ULL, 0ULL, 1ULL, 18446744069414584320ULL, 18446744073709551615ULL, 4294967294ULL,
    0ULL, 0ULL, 0ULL, 0ULL, 1499621593102562565ULL, 16692369783039433128ULL,
    15337520135922861848ULL, 5455737214495366228ULL, 17827017231032529600ULL,
    12413621606240782649ULL, 2290483008028286132ULL, 15752017553340844820ULL,
    4846430910634234874ULL, 10861682798464583253ULL, 15404737222404363049ULL, 363586619281562022ULL,
    9866710912401645115ULL, 1162548847543228595ULL, 7649967190445130486ULL, 5212340432230915749ULL,
    7572620550182916491ULL, 14876145112448665096ULL, 2063227348838176167ULL, 3519435548295415847ULL,
    8390400282019023103ULL, 17666843593163037841ULL, 9450204148816496323ULL, 8483374507652916768ULL,
    6254661047265818424ULL, 16382127809582285023ULL, 125359443771153172ULL, 1374336701588437897ULL,
    11362596098420127726ULL, 2101654420738681387ULL, 12772780342444840510ULL,
    12546934328908550060ULL, 8331880412333790397ULL, 11687262051473819904ULL,
    8926848496503457587ULL, 9603974142010467857ULL, 13199952163826973175ULL, 2189856264898797734ULL,
    11356074861870267226ULL, 2027714896422561895ULL, 5261606367808050149ULL, 153855954337762312ULL,
    6375919692894573986ULL, 12364041207536146533ULL, 1891896010455057160ULL, 1568123795087313171ULL,
    18138710056556660101ULL, 6004886947510047736ULL, 4811859325589542932ULL, 3618763430148954981ULL,
    11434521746258554122ULL, 10086341535864049427ULL, 8073421629570399570ULL,
    12680586148814729338ULL, 9619958020761569612ULL, 15827203580658384478ULL,
    12832694810937550406ULL, 14977975484447400910ULL, 5478002389061063653ULL,
    14731136312639060880ULL, 4317867687275472033ULL, 6642650962855259884ULL, 2514254944289495285ULL,
    14231405641534478436ULL, 4045448346091518946ULL, 8985477013445972471ULL, 8869039454457032149ULL,
    4356978486208692970ULL, 10805288613335538577ULL, 12832353127812502042ULL,
    4576590051676547490ULL, 6728053735138655107ULL, 17814206719173206184ULL, 79790138573994940ULL,
    17920293215101822267ULL, 13422026625585728864ULL, 5018058010492547271ULL, 110232326023384102ULL,
    10834264070056942976ULL, 15222249086119088588ULL, 15119439519142044997ULL,
    11655511970063167313ULL, 1614477029450566107ULL, 3619322817271059794ULL, 9352862040415412867ULL,
    14017522553242747074ULL, 13138513643674040327ULL, 3610195242889455765ULL,
    8371069193996567291ULL, 12670227996544662654ULL, 1205961025092146303ULL,
    13106709934003962112ULL, 4350113471327723407ULL, 15060941403739680459ULL,
    13639127647823205030ULL, 10790943339357725715ULL, 498760574280648264ULL,
    17922071907832082887ULL, 15122670976670152145ULL, 6275027991110214322ULL,
    7250912847491816402ULL, 15206617260142982380ULL, 3385668313694152877ULL,
    17522479771766801905ULL, 2965919117476170655ULL, 1553238516603269404ULL, 5820770015631050991ULL,
    4999445222232605348ULL, 9245650860833717444ULL, 1508811811724230728ULL, 5190684913765614385ULL,
    15692927070934536166ULL, 12981978499190500902ULL, 5143491963193394698ULL,
    7705698092144084129ULL, 581120653055084783ULL, 13886552864486459714ULL, 6290301270652587255ULL,
    8663431529954393128ULL, 17033405846475472443ULL, 5206780355442651635ULL,
    12580364474736467688ULL, 17934601912005283310ULL, 15119491731028933652ULL,
    17848231399859044858ULL, 4427673319524919329ULL, 2673607337074368008ULL,
    14034876464294699949ULL, 10938948975420813697ULL, 15202340615298669183ULL,
    5496603454069431071ULL, 2486526142064906845ULL, 4507882119510526802ULL, 13888151172411390059ULL,
    15049027856908071726ULL, 9667231543181973158ULL, 6406671575277563202ULL, 3395801050331215139ULL,
    9813607433539108308ULL, 2681417728820980381ULL, 18407064643927113994ULL, 7707177692113485527ULL,
    14218149384635317074ULL, 3658668346206375919ULL, 15404713991002362166ULL,
    10152074687696195207ULL, 10926946599582128139ULL, 16907298600007085320ULL,
    16544287219664720279ULL, 11007075933432813205ULL, 8652245965145713599ULL,
    7857626748965990384ULL, 5602306604520095870ULL, 2525139243938658618ULL, 14405696176872077447ULL,
    18432270482137885332ULL, 9913880809120071177ULL, 16896141737831216972ULL,
    7484791498211214829ULL, 15635259968266497469ULL, 8495118537612215624ULL, 4915477980562575356ULL,
    16453519279754924350ULL, 14462108244565406969ULL, 14837837755237096687ULL,
    14130171078892575346ULL, 15423793222528491497ULL, 5460399262075036084ULL,
    16085440580308415349ULL, 26873200736954488ULL, 5603655807457499550ULL, 3342202915871129617ULL,
    1604413932150236626ULL, 9684226585089458974ULL, 1213229904006618539ULL, 6782978662408837236ULL,
    11197029877749307372ULL, 14085968786551657744ULL, 17352273610494009342ULL,
    7876582961192434984ULL
  };

static const
uint64_t
precomp_g_pow2_128_table_w4[192U] =
  {
    0ULL, 0ULL, 0ULL, 0ULL, 1ULL, 18446744069414584320ULL, 18446744073709551615ULL, 4294967294ULL,
    0ULL, 0ULL, 0ULL, 0ULL, 14619254753077084366ULL, 13913835116514008593ULL,
    15060744674088488145ULL, 17668414598203068685ULL, 10761169236902342334ULL,
    15467027479157446221ULL, 14989185522423469618ULL, 14354539272510107003ULL,
    14298211796392133693ULL, 13270323784253711450ULL, 13380964971965046957ULL,
    8686204248456909699ULL, 17434630286744937066ULL, 1355903775279084720ULL, 7554695053550308662ULL,
    11354971222741863570ULL, 564601613420749879ULL, 8466325837259054896ULL, 10752965181772434263ULL,
    11405876547368426319ULL, 13791894568738930940ULL, 8230587134406354675ULL,
    12415514098722758608ULL, 18414183046995786744ULL, 15508000368227372870ULL,
    5781062464627999307ULL, 15339429052219195590ULL, 16038703753810741903ULL,
    9587718938298980714ULL, 4822658817952386407ULL, 1376351024833260660ULL, 1120174910554766702ULL,
    1730170933262569274ULL, 5187428548444533500ULL, 16242053503368957131ULL, 3036811119519868279ULL,
    1760267587958926638ULL, 170244572981065185ULL, 8063080791967388171ULL, 4824892826607692737ULL,
    16286391083472040552ULL, 11945158615253358747ULL, 14096887760410224200ULL,
    1613720831904557039ULL, 14316966673761197523ULL, 17411006201485445341ULL,
    8112301506943158801ULL, 2069889233927989984ULL, 10082848378277483927ULL, 3609691194454404430ULL,
    6110437205371933689ULL, 9769135977342231601ULL, 11977962151783386478ULL,
    18088718692559983573ULL, 11741637975753055ULL, 11110390325701582190ULL, 1341402251566067019ULL,
    3028229550849726478ULL, 10438984083997451310ULL, 12730851885100145709ULL,
    11524169532089894189ULL, 4523375903229602674ULL, 2028602258037385622ULL,
    17082839063089388410ULL, 6103921364634113167ULL, 17066180888225306102ULL,
    11395680486707876195ULL, 10952892272443345484ULL, 8792831960605859401ULL,
    14194485427742325139ULL, 15146020821144305250ULL, 1654766014957123343ULL,
    7955526243090948551ULL, 3989277566080493308ULL, 12229385116397931231ULL,
    13430548930727025562ULL, 3434892688179800602ULL, 8431998794645622027ULL,
    12132530981596299272ULL, 2289461608863966999ULL, 18345870950201487179ULL,
    13517947207801901576ULL, 5213113244172561159ULL, 17632986594098340879ULL,
    4405251818133148856ULL, 11783009269435447793ULL, 9332138983770046035ULL,
    12863411548922539505ULL, 3717030292816178224ULL, 10026078446427137374ULL,
    11167295326594317220ULL, 12425328773141588668ULL, 5760335125172049352ULL,
    9016843701117277863ULL, 5657892835694680172ULL, 11025130589305387464ULL, 1368484957977406173ULL,
    17361351345281258834ULL, 1907113641956152700ULL, 16439233413531427752ULL,
    5893322296986588932ULL, 14000206906171746627ULL, 14979266987545792900ULL,
    6926291766898221120ULL, 7162023296083360752ULL, 14762747553625382529ULL,
    12610831658612406849ULL, 10462926899548715515ULL, 4794017723140405312ULL,
    5234438200490163319ULL, 8019519110339576320ULL, 7194604241290530100ULL, 12626770134810813246ULL,
    10793074474236419890ULL, 11323224347913978783ULL, 16831128015895380245ULL,
    18323094195124693378ULL, 2361097165281567692ULL, 15755578675014279498ULL,
    14289876470325854580ULL, 12856787656093616839ULL, 3578928531243900594ULL,
    3847532758790503699ULL, 8377953190224748743ULL, 3314546646092744596ULL, 800810188859334358ULL,
    4626344124229343596ULL, 6620381605850876621ULL, 11422073570955989527ULL,
    12676813626484814469ULL, 16725029886764122240ULL, 16648497372773830008ULL,
    9135702594931291048ULL, 16080949688826680333ULL, 11528096561346602947ULL,
    2632498067099740984ULL, 11583842699108800714ULL, 8378404864573610526ULL, 1076560261627788534ULL,
    13836015994325032828ULL, 11234295937817067909ULL, 5893659808396722708ULL,
    11277421142886984364ULL, 8968549037166726491ULL, 14841374331394032822ULL,
    9967344773947889341ULL, 8799244393578496085ULL, 5094686877301601410ULL, 8780316747074726862ULL,
    9119697306829835718ULL, 15381243327921855368ULL, 2686250164449435196ULL,
    16466917280442198358ULL, 13791704489163125216ULL, 16955859337117924272ULL,
    17112836394923783642ULL, 4639176427338618063ULL, 16770029310141094964ULL,
    11049953922966416185ULL, 12012669590884098968ULL, 4859326885929417214ULL, 896380084392586061ULL,
    7153028362977034008ULL, 10540021163316263301ULL, 9318277998512936585ULL,
    18344496977694796523ULL, 11374737400567645494ULL, 17158800051138212954ULL,
    18343197867863253153ULL, 18204799297967861226ULL, 15798973531606348828ULL,
    9870158263408310459ULL, 17578869832774612627ULL, 8395748875822696932ULL,
    15310679007370670872ULL, 11205576736030808860ULL, 10123429210002838967ULL,
    5910544144088393959ULL, 14016615653353687369ULL, 11191676704772957822ULL
  };

static const
uint64_t
precomp_g_pow2_192_table_w4[192U] =
  {
    0ULL, 0ULL, 0ULL, 0ULL, 1ULL, 18446744069414584320ULL, 18446744073709551615ULL, 4294967294ULL,
    0ULL, 0ULL, 0ULL, 0ULL, 7870395003430845958ULL, 18001862936410067720ULL, 8006461232116967215ULL,
    5921313779532424762ULL, 10702113371959864307ULL, 8070517410642379879ULL, 7139806720777708306ULL,
    8253938546650739833ULL, 17490482834545705718ULL, 1065249776797037500ULL, 5018258455937968775ULL,
    14100621120178668337ULL, 8392845221328116213ULL, 14630296398338540788ULL,
    4268947906723414372ULL, 9231207002243517909ULL, 14261219637616504262ULL, 7786881626982345356ULL,
    11412720751765882139ULL, 14119585051365330009ULL, 15281626286521302128ULL,
    6350171933454266732ULL, 16559468304937127866ULL, 13200760478271693417ULL,
    6733381546280350776ULL, 3801404890075189193ULL, 2741036364686993903ULL, 3218612940540174008ULL,
    10894914335165419505ULL, 11862941430149998362ULL, 4223151729402839584ULL,
    2913215088487087887ULL, 14562168920104952953ULL, 2170089393468287453ULL,
    10520900655016579352ULL, 7040362608949989273ULL, 8376510559381705307ULL, 9142237200448131532ULL,
    5696859948123854080ULL, 925422306716081180ULL, 11155545953469186421ULL, 1888208646862572812ULL,
    11151095998248845721ULL, 15793503271680275267ULL, 7729877044494854851ULL,
    6235134673193032913ULL, 7364280682182401564ULL, 5479679373325519985ULL, 17966037684582301763ULL,
    14140891609330279185ULL, 5814744449740463867ULL, 5652588426712591652ULL, 774745682988690912ULL,
    13228255573220500373ULL, 11949122068786859397ULL, 8021166392900770376ULL,
    7994323710948720063ULL, 9924618472877849977ULL, 17618517523141194266ULL, 2750424097794401714ULL,
    15481749570715253207ULL, 14646964509921760497ULL, 1037442848094301355ULL,
    6295995947389299132ULL, 16915049722317579514ULL, 10493877400992990313ULL,
    18391008753060553521ULL, 483942209623707598ULL, 2017775662838016613ULL, 5933251998459363553ULL,
    11789135019970707407ULL, 5484123723153268336ULL, 13246954648848484954ULL,
    4774374393926023505ULL, 14863995618704457336ULL, 13220153167104973625ULL,
    5988445485312390826ULL, 17580359464028944682ULL, 7297100131969874771ULL, 379931507867989375ULL,
    10927113096513421444ULL, 17688881974428340857ULL, 4259872578781463333ULL,
    8573076295966784472ULL, 16389829450727275032ULL, 1667243868963568259ULL,
    17730726848925960919ULL, 11408899874569778008ULL, 3576527582023272268ULL,
    16492920640224231656ULL, 7906130545972460130ULL, 13878604278207681266ULL, 41446695125652041ULL,
    8891615271337333503ULL, 2594537723613594470ULL, 7699579176995770924ULL, 147458463055730655ULL,
    12120406862739088406ULL, 12044892493010567063ULL, 8554076749615475136ULL,
    1005097692260929999ULL, 2687202654471188715ULL, 9457588752176879209ULL, 17472884880062444019ULL,
    9792097892056020166ULL, 2525246678512797150ULL, 15958903035313115662ULL,
    11336038170342247032ULL, 11560342382835141123ULL, 6212009033479929024ULL,
    8214308203775021229ULL, 8475469210070503698ULL, 13287024123485719563ULL,
    12956951963817520723ULL, 10693035819908470465ULL, 11375478788224786725ULL,
    16934625208487120398ULL, 10094585729115874495ULL, 2763884524395905776ULL,
    13535890148969964883ULL, 13514657411765064358ULL, 9903074440788027562ULL,
    17324720726421199990ULL, 2273931039117368789ULL, 3442641041506157854ULL, 1119853641236409612ULL,
    12037070344296077989ULL, 581736433335671746ULL, 6019150647054369174ULL, 14864096138068789375ULL,
    6652995210998318662ULL, 12773883697029175304ULL, 12751275631451845119ULL,
    11449095003038250478ULL, 1025805267334366480ULL, 2764432500300815015ULL,
    18274564429002844381ULL, 10445634195592600351ULL, 11814099592837202735ULL,
    5006796893679120289ULL, 6908397253997261914ULL, 13266696965302879279ULL, 7768715053015037430ULL,
    3569923738654785686ULL, 5844853453464857549ULL, 1837340805629559110ULL, 1034657624388283114ULL,
    711244516069456460ULL, 12519286026957934814ULL, 2613464944620837619ULL, 10003023321338286213ULL,
    7291332092642881376ULL, 9832199564117004897ULL, 3280736694860799890ULL, 6416452202849179874ULL,
    7326961381798642069ULL, 8435688798040635029ULL, 16630141263910982958ULL,
    17222635514422533318ULL, 9482787389178881499ULL, 836561194658263905ULL, 3405319043337616649ULL,
    2786146577568026518ULL, 7625483685691626321ULL, 6728084875304656716ULL, 1140997959232544268ULL,
    12847384827606303792ULL, 1719121337754572070ULL, 12863589482936438532ULL,
    3880712899640530862ULL, 2748456882813671564ULL, 4775988900044623019ULL, 8937847374382191162ULL,
    3767367347172252295ULL, 13468672401049388646ULL, 14359032216842397576ULL,
    2002555958685443975ULL, 16488678606651526810ULL, 11826135409597474760ULL,
    15296495673182508601ULL
  };

static void precomp_get_consttime(const uint64_t *table, uint64_t bits_l, uint64_t *tmp)
{
  memcpy(tmp, (uint64_t *)table, 12U * sizeof (uint64_t));
  for (uint32_t i0 = 0U; i0 < 15U; i0++)
  {
    uint64_t c = FStar_UInt64_eq_mask(bits_l, (uint64_t)(i0 + 1U));
    const uint64_t *res_j = table + (i0 + 1U) * 12U;
    for (uint32_t i = 0U; i < 12U; i++)
    {
      uint64_t *os = tmp;
      uint64_t x = (c & res_j[i]) | (~c & tmp[i]);
      os[i] = x;
    }
  }
}

static void point_mul_g(uint64_t *res, uint64_t *scalar)
{
  uint64_t q1[12U] = { 0U };
  make_base_point(q1);
  uint64_t
  q2[12U] =
    {
      1499621593102562565ULL, 16692369783039433128ULL, 15337520135922861848ULL,
      5455737214495366228ULL, 17827017231032529600ULL, 12413621606240782649ULL,
      2290483008028286132ULL, 15752017553340844820ULL, 4846430910634234874ULL,
      10861682798464583253ULL, 15404737222404363049ULL, 363586619281562022ULL
    };
  uint64_t
  q3[12U] =
    {
      14619254753077084366ULL, 13913835116514008593ULL, 15060744674088488145ULL,
      17668414598203068685ULL, 10761169236902342334ULL, 15467027479157446221ULL,
      14989185522423469618ULL, 14354539272510107003ULL, 14298211796392133693ULL,
      13270323784253711450ULL, 13380964971965046957ULL, 8686204248456909699ULL
    };
  uint64_t
  q4[12U] =
    {
      7870395003430845958ULL, 18001862936410067720ULL, 8006461232116967215ULL,
      5921313779532424762ULL, 10702113371959864307ULL, 8070517410642379879ULL,
      7139806720777708306ULL, 8253938546650739833ULL, 17490482834545705718ULL,
      1065249776797037500ULL, 5018258455937968775ULL, 14100621120178668337ULL
    };
  uint64_t *r1 = scalar;
  uint64_t *r2 = scalar + 1U;
  uint64_t *r3 = scalar + 2U;
  uint64_t *r4 = scalar + 3U;
  make_point_at_inf(res);
  uint64_t tmp[12U] = { 0U };
  for (uint32_t i = 0U; i < 16U; i++)
  {
    for (uint32_t i = 0U; i < 4U; i++)
      point_double(res, res);
    uint32_t k = 64U - 4U * i - 4U;
    uint64_t bits_l = bn_get_bits_u64(1U, r4, k, 4U);
    precomp_get_consttime(precomp_g_pow2_192_table_w4, bits_l, tmp);
    point_add(res, res, tmp);
    uint32_t k0 = 64U - 4U * i - 4U;
    uint64_t bits_l0 = bn_get_bits_u64(1U, r3, k0, 4U);
    precomp_get_consttime(precomp_g_pow2_128_table_w4, bits_l0, tmp);
    point_add(res, res, tmp);
    uint32_t k1 = 64U - 4U * i - 4U;
    uint64_t bits_l1 = bn_get_bits_u64(1U, r2, k1, 4U);
    precomp_get_consttime(precomp_g_pow2_64_table_w4, bits_l1, tmp);
    point_add(res, res, tmp);
    uint32_t k2 = 64U - 4U * i - 4U;
    uint64_t bits_l2 = bn_get_bits_u64(1U, r1, k2, 4U);
    precomp_get_consttime(precomp_basepoint_table_w4, bits_l2, tmp);
    point_add(res, res, tmp);
  }
  KRML_MAYBE_UNUSED_VAR(q1);
  KRML_MAYBE_UNUSED_VAR(q2);
  KRML_MAYBE_UNUSED_VAR(q3);
  KRML_MAYBE_UNUSED_VAR(q4);
}

static uint64_t bn_is_lt_order_mask4(uint64_t *f)
{
  uint64_t tmp[4U] = { 0U };
  make_order(tmp);
  uint64_t c = bn_sub4(tmp, f, tmp);
  return 0ULL - c;
}

static uint64_t bn_is_lt_order_and_gt_zero_mask4(uint64_t *f)
{
  uint64_t is_lt_order = bn_is_lt_order_mask4(f);
  uint64_t is_eq_zero = bn_is_zero_mask4(f);
  return is_lt_order & ~is_eq_zero;
}

static void qmod_short(uint64_t *res, uint64_t *x)
{
  uint64_t tmp[4U] = { 0U };
  make_order(tmp);
  uint64_t c = bn_sub4(tmp, x, tmp);
  bn_cmovznz4(res, c, tmp, x);
}

static void qadd(uint64_t *res, uint64_t *x, uint64_t *y)
{
  uint64_t n[4U] = { 0U };
  make_order(n);
  bn_add_mod4(res, n, x, y);
}

static void qmont_reduction(uint64_t *res, uint64_t *x)
{
  uint64_t n[4U] = { 0U };
  make_order(n);
  uint64_t c0 = 0ULL;
  for (uint32_t i0 = 0U; i0 < 4U; i0++)
  {
    uint64_t qj = 0xccd1c8aaee00bc4fULL * x[i0];
    uint64_t *res_j0 = x + i0;
    uint64_t c = 0ULL;
    for (uint32_t i = 0U; i < 1U; i++)
    {
      uint64_t a_i = n[4U * i];
      uint64_t *res_i0 = res_j0 + 4U * i;
      c = mul_wide_add2_u64(a_i, qj, c, res_i0);
      uint64_t a_i0 = n[4U * i + 1U];
      uint64_t *res_i1 = res_j0 + 4U * i + 1U;
      c = mul_wide_add2_u64(a_i0, qj, c, res_i1);
      uint64_t a_i1 = n[4U * i + 2U];
      uint64_t *res_i2 = res_j0 + 4U * i + 2U;
      c = mul_wide_add2_u64(a_i1, qj, c, res_i2);
      uint64_t a_i2 = n[4U * i + 3U];
      uint64_t *res_i = res_j0 + 4U * i + 3U;
      c = mul_wide_add2_u64(a_i2, qj, c, res_i);
    }
    for (uint32_t i = 4U; i < 4U; i++)
    {
      uint64_t a_i = n[i];
      uint64_t *res_i = res_j0 + i;
      c = mul_wide_add2_u64(a_i, qj, c, res_i);
    }
    uint64_t r = c;
    uint64_t c1 = r;
    uint64_t *resb = x + 4U + i0;
    uint64_t res_j = x[4U + i0];
    c0 = Lib_IntTypes_Intrinsics_add_carry_u64(c0, c1, res_j, resb);
  }
  memcpy(res, x + 4U, 4U * sizeof (uint64_t));
  uint64_t c00 = c0;
  uint64_t tmp[4U] = { 0U };
  uint64_t c = 0ULL;
  for (uint32_t i = 0U; i < 1U; i++)
  {
    uint64_t t1 = res[4U * i];
    uint64_t t20 = n[4U * i];
    uint64_t *res_i0 = tmp + 4U * i;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t1, t20, res_i0);
    uint64_t t10 = res[4U * i + 1U];
    uint64_t t21 = n[4U * i + 1U];
    uint64_t *res_i1 = tmp + 4U * i + 1U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t10, t21, res_i1);
    uint64_t t11 = res[4U * i + 2U];
    uint64_t t22 = n[4U * i + 2U];
    uint64_t *res_i2 = tmp + 4U * i + 2U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t11, t22, res_i2);
    uint64_t t12 = res[4U * i + 3U];
    uint64_t t2 = n[4U * i + 3U];
    uint64_t *res_i = tmp + 4U * i + 3U;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t12, t2, res_i);
  }
  for (uint32_t i = 4U; i < 4U; i++)
  {
    uint64_t t1 = res[i];
    uint64_t t2 = n[i];
    uint64_t *res_i = tmp + i;
    c = Lib_IntTypes_Intrinsics_sub_borrow_u64(c, t1, t2, res_i);
  }
  uint64_t c1 = c;
  uint64_t c2 = c00 - c1;
  for (uint32_t i = 0U; i < 4U; i++)
  {
    uint64_t *os = res;
    uint64_t x1 = (c2 & res[i]) | (~c2 & tmp[i]);
    os[i] = x1;
  }
}

static void from_qmont(uint64_t *res, uint64_t *x)
{
  uint64_t tmp[8U] = { 0U };
  memcpy(tmp, x, 4U * sizeof (uint64_t));
  qmont_reduction(res, tmp);
}

static void qmul(uint64_t *res, uint64_t *x, uint64_t *y)
{
  uint64_t tmp[8U] = { 0U };
  bn_mul4(tmp, x, y);
  qmont_reduction(res, tmp);
}

static void qsqr(uint64_t *res, uint64_t *x)
{
  uint64_t tmp[8U] = { 0U };
  bn_sqr4(tmp, x);
  qmont_reduction(res, tmp);
}

/**
Hash `input`, of len `input_len`, into `output`, an array of 32 bytes.
*/
static void hash_256(uint8_t *output, uint8_t *input, uint32_t input_len)
{
  uint8_t *ib = input;
  uint8_t *rb = output;
  uint32_t st[8U] = { 0U };
  sha256_init(st);
  uint32_t rem = input_len % 64U;
  uint64_t len_ = (uint64_t)input_len;
  sha256_update_nblocks(input_len, ib, st);
  uint32_t rem1 = input_len % 64U;
  uint8_t *b0 = ib;
  uint8_t *lb = b0 + input_len - rem1;
  sha256_update_last(len_, rem, lb, st);
  sha256_finish(st, rb);
}

static void qinv(uint64_t *res, uint64_t *r)
{
  uint64_t tmp[28U] = { 0U };
  uint64_t *x6 = tmp;
  uint64_t *x_11 = tmp + 4U;
  uint64_t *x_101 = tmp + 8U;
  uint64_t *x_111 = tmp + 12U;
  uint64_t *x_1111 = tmp + 16U;
  uint64_t *x_10101 = tmp + 20U;
  uint64_t *x_101111 = tmp + 24U;
  memcpy(x6, r, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 1U; i++)
    qsqr(x6, x6);
  qmul(x_11, x6, r);
  qmul(x_101, x6, x_11);
  qmul(x_111, x6, x_101);
  memcpy(x6, x_101, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 1U; i++)
    qsqr(x6, x6);
  qmul(x_1111, x_101, x6);
  for (uint32_t i = 0U; i < 1U; i++)
    qsqr(x6, x6);
  qmul(x_10101, x6, r);
  memcpy(x6, x_10101, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 1U; i++)
    qsqr(x6, x6);
  qmul(x_101111, x_101, x6);
  qmul(x6, x_10101, x6);
  uint64_t tmp1[4U] = { 0U };
  for (uint32_t i = 0U; i < 2U; i++)
    qsqr(x6, x6);
  qmul(x6, x6, x_11);
  memcpy(tmp1, x6, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 8U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x6);
  memcpy(x6, tmp1, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 16U; i++)
    qsqr(x6, x6);
  qmul(x6, x6, tmp1);
  memcpy(tmp1, x6, 4U * sizeof (uint64_t));
  for (uint32_t i = 0U; i < 64U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x6);
  for (uint32_t i = 0U; i < 32U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x6);
  for (uint32_t i = 0U; i < 6U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_101111);
  for (uint32_t i = 0U; i < 5U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_111);
  for (uint32_t i = 0U; i < 4U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_11);
  for (uint32_t i = 0U; i < 5U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_1111);
  for (uint32_t i = 0U; i < 5U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_10101);
  for (uint32_t i = 0U; i < 4U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_101);
  for (uint32_t i = 0U; i < 3U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_101);
  for (uint32_t i = 0U; i < 3U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_101);
  for (uint32_t i = 0U; i < 5U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_111);
  for (uint32_t i = 0U; i < 9U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_101111);
  for (uint32_t i = 0U; i < 6U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_1111);
  for (uint32_t i = 0U; i < 2U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, r);
  for (uint32_t i = 0U; i < 5U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, r);
  for (uint32_t i = 0U; i < 6U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_1111);
  for (uint32_t i = 0U; i < 5U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_111);
  for (uint32_t i = 0U; i < 4U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_111);
  for (uint32_t i = 0U; i < 5U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_111);
  for (uint32_t i = 0U; i < 5U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_101);
  for (uint32_t i = 0U; i < 3U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_11);
  for (uint32_t i = 0U; i < 10U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_101111);
  for (uint32_t i = 0U; i < 2U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_11);
  for (uint32_t i = 0U; i < 5U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_11);
  for (uint32_t i = 0U; i < 5U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_11);
  for (uint32_t i = 0U; i < 3U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, r);
  for (uint32_t i = 0U; i < 7U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_10101);
  for (uint32_t i = 0U; i < 6U; i++)
    qsqr(tmp1, tmp1);
  qmul(tmp1, tmp1, x_1111);
  memcpy(x6, tmp1, 4U * sizeof (uint64_t));
  memcpy(res, x6, 4U * sizeof (uint64_t));
}

static uint32_t
ecdsa_sign_msg_as_qelem(
  uint8_t *signature,
  uint64_t *m_q,
  uint8_t *private_key,
  uint8_t *nonce
)
{
  uint64_t rsdk_q[16U] = { 0U };
  uint64_t *r_q = rsdk_q;
  uint64_t *s_q = rsdk_q + 4U;
  uint64_t *d_a = rsdk_q + 8U;
  uint64_t *k_q = rsdk_q + 12U;
  bn_from_bytes_be4(d_a, private_key);
  uint64_t is_b_valid0 = bn_is_lt_order_and_gt_zero_mask4(d_a);
  uint64_t oneq0[4U] = { 0U };
  oneq0[0U] = 1ULL;
  oneq0[1U] = 0ULL;
  oneq0[2U] = 0ULL;
  oneq0[3U] = 0ULL;
  for (uint32_t i = 0U; i < 4U; i++)
  {
    uint64_t *os = d_a;
    uint64_t uu____0 = oneq0[i];
    uint64_t x = uu____0 ^ (is_b_valid0 & (d_a[i] ^ uu____0));
    os[i] = x;
  }
  uint64_t is_sk_valid = is_b_valid0;
  bn_from_bytes_be4(k_q, nonce);
  uint64_t is_b_valid = bn_is_lt_order_and_gt_zero_mask4(k_q);
  uint64_t oneq[4U] = { 0U };
  oneq[0U] = 1ULL;
  oneq[1U] = 0ULL;
  oneq[2U] = 0ULL;
  oneq[3U] = 0ULL;
  for (uint32_t i = 0U; i < 4U; i++)
  {
    uint64_t *os = k_q;
    uint64_t uu____1 = oneq[i];
    uint64_t x = uu____1 ^ (is_b_valid & (k_q[i] ^ uu____1));
    os[i] = x;
  }
  uint64_t is_nonce_valid = is_b_valid;
  uint64_t are_sk_nonce_valid = is_sk_valid & is_nonce_valid;
  uint64_t p[12U] = { 0U };
  point_mul_g(p, k_q);
  to_aff_point_x(r_q, p);
  qmod_short(r_q, r_q);
  uint64_t kinv[4U] = { 0U };
  qinv(kinv, k_q);
  qmul(s_q, r_q, d_a);
  from_qmont(m_q, m_q);
  qadd(s_q, m_q, s_q);
  qmul(s_q, kinv, s_q);
  bn2_to_bytes_be4(signature, r_q, s_q);
  uint64_t is_r_zero = bn_is_zero_mask4(r_q);
  uint64_t is_s_zero = bn_is_zero_mask4(s_q);
  uint64_t m = are_sk_nonce_valid & (~is_r_zero & ~is_s_zero);
  uint32_t res = (uint32_t)m;
  return res;
}

/**
Create an ECDSA signature WITHOUT hashing first.

  This function is intended to receive a hash of the input.
  For convenience, we recommend using one of the hash-and-sign combined functions above.

  The argument `msg` MUST be at least 32 bytes (i.e. `msg_len >= 32`).

  NOTE: The equivalent functions in OpenSSL and Fiat-Crypto both accept inputs
  smaller than 32 bytes. These libraries left-pad the input with enough zeroes to
  reach the minimum 32 byte size. Clients who need behavior identical to OpenSSL
  need to perform the left-padding themselves.

  The function returns `true` for successful creation of an ECDSA signature and `false` otherwise.

  The outparam `signature` (R || S) points to 64 bytes of valid memory, i.e., uint8_t[64].
  The argument `msg` points to `msg_len` bytes of valid memory, i.e., uint8_t[msg_len].
  The arguments `private_key` and `nonce` point to 32 bytes of valid memory, i.e., uint8_t[32].

  The function also checks whether `private_key` and `nonce` are valid values:
    • 0 < `private_key` < the order of the curve
    • 0 < `nonce` < the order of the curve
*/
uint32_t
Hacl_P256_ecdsa_sign_p256_without_hash(
  uint8_t *signature,
  uint32_t msg_len,
  uint8_t *msg,
  uint8_t *private_key,
  uint8_t *nonce
)
{
  uint64_t m_q[4U] = { 0U };
  uint8_t mHash[32U] = { 0U };
  memcpy(mHash, msg, 32U * sizeof (uint8_t));
  KRML_MAYBE_UNUSED_VAR(msg_len);
  uint8_t *mHash32 = mHash;
  bn_from_bytes_be4(m_q, mHash32);
  qmod_short(m_q, m_q);
  uint32_t res = ecdsa_sign_msg_as_qelem(signature, m_q, private_key, nonce);
  return res;
}

typedef struct __uint32_t_uint32_t_s
{
  uint32_t fst;
  uint32_t snd;
}
__uint32_t_uint32_t;

/**
Write the HMAC-SHA-2-256 MAC of a message (`data`) by using a key (`key`) into `dst`.

The key can be any length and will be hashed if it is longer and padded if it is shorter than 64 bytes.
`dst` must point to 32 bytes of memory.
*/
void
Hacl_HMAC_compute_sha2_256(
  uint8_t *dst,
  uint8_t *key,
  uint32_t key_len,
  uint8_t *data,
  uint32_t data_len
)
{
  uint32_t l = 64U;
  KRML_CHECK_SIZE(sizeof (uint8_t), l);
  uint8_t key_block[64U];
  memset(key_block, 0U, l * sizeof (uint8_t));
  uint8_t *nkey = key_block;
  uint32_t ite;
  if (key_len <= 64U)
    ite = key_len;
  else
    ite = 32U;
  uint8_t *zeroes = key_block + ite;
  KRML_MAYBE_UNUSED_VAR(zeroes);
  if (key_len <= 64U)
    memcpy(nkey, key, key_len * sizeof (uint8_t));
  else
    hash_256(nkey, key, key_len);
  KRML_CHECK_SIZE(sizeof (uint8_t), l);
  uint8_t ipad[64U];
  memset(ipad, 0x36U, l * sizeof (uint8_t));
  for (uint32_t i = 0U; i < l; i++)
  {
    uint8_t xi = ipad[i];
    uint8_t yi = key_block[i];
    ipad[i] = (uint32_t)xi ^ (uint32_t)yi;
  }
  KRML_CHECK_SIZE(sizeof (uint8_t), l);
  uint8_t opad[64U];
  memset(opad, 0x5cU, l * sizeof (uint8_t));
  for (uint32_t i = 0U; i < l; i++)
  {
    uint8_t xi = opad[i];
    uint8_t yi = key_block[i];
    opad[i] = (uint32_t)xi ^ (uint32_t)yi;
  }
  uint32_t st[8U] = { 0U };
  for (uint32_t i = 0U; i < 8U; i++)
  {
    uint32_t *os = st;
    uint32_t x = h256[i];
    os[i] = x;
  }
  uint32_t *s = st;
  uint8_t *dst1 = ipad;
  if (data_len == 0U)
    sha256_update_last(0ULL + (uint64_t)64U, 64U, ipad, s);
  else
  {
    uint32_t block_len = 64U;
    uint32_t n_blocks0 = data_len / block_len;
    uint32_t rem0 = data_len % block_len;
    __uint32_t_uint32_t scrut;
    if (n_blocks0 > 0U && rem0 == 0U)
    {
      uint32_t n_blocks_ = n_blocks0 - 1U;
      scrut = ((__uint32_t_uint32_t){ .fst = n_blocks_, .snd = data_len - n_blocks_ * block_len });
    }
    else
      scrut = ((__uint32_t_uint32_t){ .fst = n_blocks0, .snd = rem0 });
    uint32_t n_blocks = scrut.fst;
    uint32_t rem_len = scrut.snd;
    uint32_t full_blocks_len = n_blocks * block_len;
    uint8_t *full_blocks = data;
    uint8_t *rem = data + full_blocks_len;
    sha256_update_nblocks(64U, ipad, s);
    sha256_update_nblocks(n_blocks * 64U, full_blocks, s);
    sha256_update_last((uint64_t)64U + (uint64_t)full_blocks_len + (uint64_t)rem_len,
      rem_len,
      rem,
      s);
  }
  sha256_finish(s, dst1);
  uint8_t *hash1 = ipad;
  sha256_init(s);
  uint32_t block_len = 64U;
  uint32_t n_blocks0 = 32U / block_len;
  uint32_t rem0 = 32U % block_len;
  __uint32_t_uint32_t scrut;
  if (n_blocks0 > 0U && rem0 == 0U)
  {
    uint32_t n_blocks_ = n_blocks0 - 1U;
    scrut = ((__uint32_t_uint32_t){ .fst = n_blocks_, .snd = 32U - n_blocks_ * block_len });
  }
  else
    scrut = ((__uint32_t_uint32_t){ .fst = n_blocks0, .snd = rem0 });
  uint32_t n_blocks = scrut.fst;
  uint32_t rem_len = scrut.snd;
  uint32_t full_blocks_len = n_blocks * block_len;
  uint8_t *full_blocks = hash1;
  uint8_t *rem = hash1 + full_blocks_len;
  sha256_update_nblocks(64U, opad, s);
  sha256_update_nblocks(n_blocks * 64U, full_blocks, s);
  sha256_update_last((uint64_t)64U + (uint64_t)full_blocks_len + (uint64_t)rem_len,
    rem_len,
    rem,
    s);
  sha256_finish(s, dst);
}

